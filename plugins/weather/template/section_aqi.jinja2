<div class="subcard air-content">
  <span class="title">空气质量 {{ aqi.category }}</span>
  <div class="aqi">
    <div class="aqi-icon">
      <svg
        viewBox="0 0 100 100"
        width="15rem"
        height="15rem"
      >
        <circle
          fill="transparent"
          stroke-width="10"
          r="45"
          cx="50"
          cy="50"
          stroke="hsl({{ [(300 - aqi.aqi) / 300 * 140, 0] | max }}, 85%, 30%)"
        ></circle>
        <circle
          fill="transparent"
          stroke-width="10"
          r="45"
          cx="50"
          cy="50"
          stroke-linecap="round"
          stroke="hsl({{ [(300 - aqi.aqi) / 300 * 140, 0] | max }}, 92%, 40%)";
          stroke-dasharray="300"
          stroke-dashoffset="{{ [(300 - aqi.aqi), 0] | max }}"
        ></circle>
      </svg>
      <span>{{ aqi.aqi }}</span>
    </div>
    <span>AQI</span>
  </div>
  {% for detail in aqi.detail %}
    <div class="aqi-detail">
      <span>{{ detail.value }}</span>
      <svg
        viewBox="0 0 110 20"
        width="12rem"
      >
        <line
          x1="3" y1="10" x2="103" y2="10"
          stroke-width="6"
          stroke-linecap="round"
          stroke="hsl({{ (1 - detail.percent)  * 100 }}, 85%, 30%)"/>
        <line
          x1="3" y1="10" x2="103" y2="10"
          stroke-width="6"
          stroke-linecap="round"
          stroke="hsl({{ (1 - detail.percent)  * 100 }}, 92%, 40%)"
          stroke-dasharray="100"
          stroke-dashoffset="{{(1 - detail.percent) * 100}}"/>
      </svg>
      <span>{{ detail.name }}</span>
    </div>
  {% endfor %}
</div>

<style>

.air-content {
  position: relative;
  display: inline-grid;
  grid-template-columns: 3fr 2fr 2fr 2fr;
  justify-items: center;
  align-items: center;
  gap: 2rem;
}

.air-content > .title {
  grid-row: 1;
  grid-column: 2 / 5;
}

.aqi {
  grid-row: 1 / 4;
  grid-column: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: relative;
}

.aqi > span {
  color: lightgray;
}

.aqi-icon {
  position: relative;
  padding: 1em;
}

.aqi-icon svg {
  display: block;
}

.aqi-icon span {
  position: absolute;
  top: 50%;
  left: 50%;
  translate: -50% -50%;
  font-size: 1.5em;
  font-weight: bold;
}

.aqi-detail {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.aqi-detail span:nth-child(1) {
  font-weight: bold;
}

.aqi-detail span:nth-child(3) {
  color: lightgray;
  font-size: 0.8em;
}

</style>